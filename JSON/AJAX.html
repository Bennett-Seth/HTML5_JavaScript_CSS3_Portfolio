<!DOCTYPE HTML>
	<html lang="en-us">
		<head>
			<meta charset="utf-8">
			<title>XMLHttpRequest for JSON Web Service</title>
			
		</head>
		<body>
			
<!-- Important. Do your OWN examples. Don't just copy and paste them from the tutorial. -->	

<!-- Link to AJAX Tutorial - https://www.w3schools.com/js/js_ajax_intro.asp -->	
			
			<h1> Definitions for Server Responses </h1>
			
			<table style="width:50%" border="1pt">
				<tr>
					<th> Property </th>
					<th> Description </th>
				</tr>
				<tr>
					<td> onreadystatechange </td>
					<td> Calls the function when the property's readyState changes </td>
				</tr>
				<tr>
					<td> readyState </td>
					<td> Holds the XMLHttpRequest until: 
						<br> 0: request not started
						<br> 1: make connection with the server
						<br> 2: got the request
						<br> 3: processing the request
						<br> 4: request finished and response is ready
					</td>
				</tr>
				<tr>
					<td> status </td>
					<td> 
						<br> 200: "OK"
						<br> 403: "Forbidden"
						<br> 404: "Page not found"
						<br> <a href="https://www.w3schools.com/tags/ref_httpmessages.asp"> More here </a>
					 </td>
				</tr>
				<tr>
					<td> statusText </td>
					<td> Returns the status-text (example: "Forbidden") </td>
				</tr>
			</table>
			
			
			<h1>*Using JSON to send data via a AJAX</h1>
			
				<p>Step 1: Convert a JavaScript object into a JSON string </p>
				<p>Step 2: Send it to the server.</p>
				<p> NOTE: Using this code <b> crashed </b> my program... HELP! </p>

				<script>
				//var myCharacter = { name: "Peter Parker", age: 16, city: "New York" };
				//var myJSON = JSON.stringify(myCharacter);
				//window.location = "demo_json.php?x=" + myJSON;
				</script>
							
			<h1>Using JSON to receive data</h1>
			
			<h2> AJAX Request via JSON </h2>
				
				<p>Use the AJAX Request (aka XMLHttpRequest) to get the content of a file.</p>
				<p>The content must be in JSON format, so it can easily be converted into a JavaScript object.</p>

				<p id="demo_1"></p>
			
				<button type="button" onclick="loadDoc_1()">Who is my character?</button>

				<script>

				function loadDoc_1(){
				var xmlhttp = new XMLHttpRequest();
				xmlhttp.onreadystatechange = function() {
					if (this.readyState == 4 && this.status == 200) {
					var myObj = JSON.parse(this.responseText);
						document.getElementById("demo_1").innerHTML = "My Character's name is " + myObj.name;
					}
					};
				xmlhttp.open("GET", "json_ajax_demo.txt", true);
				xmlhttp.send();
				}

				</script>

				<!-- <p>Take a look at <a href="json_ajax_demo.txt" target="_blank">json_ajax_demo.txt</a></p>
				-->
				
			<h2> * (customize) Compatability with older browsers (IE5 and IE6) </h2>
			
				<p> Older versions use the ActiveX object instead of the XMLHttpRequest object. </p>

				<button type="button" onclick="loadDoc_2()">Why did Batman take Wonder Woman to the used car dealership?</button>

				<p id="demo_2"></p>
			
				<script>
				function loadDoc_2() {
					var xhttp;
					var myObj;
				  if (window.XMLHttpRequest) {
					// code for modern browsers
					xhttp = new XMLHttpRequest();
						} else {
					// code for IE6, IE5
					xhttp = new ActiveXObject("Microsoft.XMLHTTP");
				  		}
				 	xhttp.onreadystatechange = function() {
					if (this.readyState == 4 && this.status == 200) {
					  	//myObj = JSON.parse(this.responseText);
						document.getElementById("demo_2").innerHTML = this.responseText;
						}
				  	};
				  xhttp.open("GET", "riddle_answer.txt", true);
				  xhttp.send();
				}
				</script>
			
			<h1> *Callback Functions </h1>

				<h2>When you pass a parameter as a function, to another function. </h2>
					
				<p> This is a great way to divide multiple AJAX tasks </p>
			
			<div id="demo_3">	
			</div>
		
				<button type="button"
					onclick="loadDoc('json_ajax_demo.txt', myFunction)">Change Content
					</button>

				<script>
				function loadDoc(url, cFunction) {
				  var xhttp;
				  xhttp=new XMLHttpRequest();
				  xhttp.onreadystatechange = function() {
				    if (this.readyState == 4 && this.status == 200) {
				      cFunction(this);
				    }
				  };
				  xhttp.open("GET", url, true);
				  xhttp.send();
				}
				function myFunction(xhttp) {
				  document.getElementById("demo_3").innerHTML =
				  xhttp.responseText;
				}
				</script>
				
			
		</body>	
	</html>
